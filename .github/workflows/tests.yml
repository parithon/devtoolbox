name: Tests

on:
  push:
    branches:
    - actions-tests

jobs:
  Test-ModuleManifest:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v1
    - name: Test-ModuleManifest
      run: |
        Test-ModuleManifest ./src/devtoolbox.psd1

  Invoke-Pester:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v1
    - name: Bootstrap Powershell
      run: |
        & ./_build/bootstrap.ps1
    - name: Invoke-Pester
      run: |
        Invoke-Pester -OutputFile TestResults.xml -OutputFormat NUnitXml
    - uses: actions/upload-artifact/@v1
      with:
        name: Test Results
        path: ./TestResults.Xml
